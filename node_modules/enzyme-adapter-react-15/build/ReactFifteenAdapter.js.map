{"version":3,"sources":["../src/ReactFifteenAdapter.js"],"names":["compositeTypeToNodeType","type","Error","childrenFromInst","inst","el","_renderedChildren","props","children","nodeType","_compositeType","instanceToTree","_currentElement","key","ref","instance","_instance","_hostNode","rendered","map","_renderedComponent","eventOptions","animation","ReactFifteenAdapter","lifecycles","options","supportPrevContextArgumentOfComponentDidUpdate","legacyContextMode","componentDidUpdate","prevContext","getChildContext","calledByRenderer","domNode","attachTo","global","document","createElement","adapter","render","context","callback","wrapperProps","Component","wrappingComponentProps","ReactWrapperComponent","wrappedEl","React","ReactDOM","setChildProps","unmount","unmountComponentAtNode","getNode","isCustomComponent","_reactInternalInstance","simulateEvent","node","event","mock","mappedEvent","eventFn","TestUtils","Simulate","TypeError","findDOMNode","batchedUpdates","fn","unstable_batchedUpdates","getWrappingComponentRenderer","toTree","getMountWrapperInstance","renderer","ShallowRenderer","isDOM","cachedNode","output","getRenderOutput","args","handler","contextTypes","childContextTypes","ContextWrapper","ReactDOMServer","renderToStaticMarkup","mode","EnzymeAdapter","MODES","MOUNT","createMountRenderer","SHALLOW","createShallowRenderer","STRING","createStringRenderer","element","object","component","call","undefined","RootFinder","module","exports"],"mappings":";;;;;AAEA;;AAEA;;AAEA;;;;;;;AANA;;;;AACA;;;;AAEA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;;;;;;;AAkBA,SAASA,uBAAT,CAAiCC,IAAjC,EAAuC;AACrC,UAAQA,IAAR;AACE,SAAK,CAAL;AACA,SAAK,CAAL;AAAQ,aAAO,OAAP;AACR,SAAK,CAAL;AAAQ,aAAO,UAAP;AACR;AACE,YAAM,IAAIC,KAAJ,2DAA2DD,IAA3D,EAAN;AALJ;AAOD;AACD,SAASE,gBAAT,CAA0BC,IAA1B,EAAgCC,EAAhC,EAAoC;AAClC,MAAID,KAAKE,iBAAT,EAA4B;AAC1B,WAAO,yBAAOF,KAAKE,iBAAZ,CAAP;AACD;AACD,MAAID,GAAGE,KAAP,EAAc;AACZ,WAAO,yBAAO,EAAE,MAAMF,GAAGE,KAAH,CAASC,QAAjB,EAAP,CAAP;AACD;AACD,SAAO,EAAP;AACD;;AAED,SAASC,QAAT,CAAkBL,IAAlB,EAAwB;AACtB,MAAIA,KAAKM,cAAL,IAAuB,IAA3B,EAAiC;AAC/B,WAAOV,wBAAwBI,KAAKM,cAA7B,CAAP;AACD;AACD,SAAO,MAAP;AACD;;AAED,SAASC,cAAT,CAAwBP,IAAxB,EAA8B;AAC5B,MAAI,CAACA,IAAD,IAAS,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAA7B,EAAuC;AACrC,WAAOA,IAAP;AACD;AACD,MAAMC,KAAKD,KAAKQ,eAAhB;AACA,MAAIP,MAAM,IAAN,IAAcA,OAAO,KAAzB,EAAgC;AAC9B,WAAO,IAAP;AACD;AACD,MAAI,QAAOA,EAAP,yCAAOA,EAAP,OAAc,QAAlB,EAA4B;AAC1B,WAAOA,EAAP;AACD;AACD,MAAID,KAAKE,iBAAT,EAA4B;AAC1B,WAAO;AACLG,gBAAUA,SAASL,IAAT,CADL;AAELH,YAAMI,GAAGJ,IAFJ;AAGLM,aAAOF,GAAGE,KAHL;AAILM,WAAK,8CAAqBR,GAAGQ,GAAxB,CAJA;AAKLC,WAAKT,GAAGS,GALH;AAMLC,gBAAUX,KAAKY,SAAL,IAAkBZ,KAAKa,SAAvB,IAAoC,IANzC;AAOLC,gBAAU,yBAAOd,KAAKE,iBAAZ,EAA+Ba,GAA/B,CAAmCR,cAAnC;AAPL,KAAP;AASD;AACD,MAAIP,KAAKa,SAAT,EAAoB;AAClB,WAAO;AACLR,gBAAU,MADL;AAELR,YAAMI,GAAGJ,IAFJ;AAGLM,aAAOF,GAAGE,KAHL;AAILM,WAAK,8CAAqBR,GAAGQ,GAAxB,CAJA;AAKLC,WAAKT,GAAGS,GALH;AAMLC,gBAAUX,KAAKY,SAAL,IAAkBZ,KAAKa,SAAvB,IAAoC,IANzC;AAOLC,gBAAUf,iBAAiBC,IAAjB,EAAuBC,EAAvB,EAA2Bc,GAA3B,CAA+BR,cAA/B;AAPL,KAAP;AASD;AACD,MAAIP,KAAKgB,kBAAT,EAA6B;AAC3B,WAAO;AACLX,gBAAUA,SAASL,IAAT,CADL;AAELH,YAAMI,GAAGJ,IAFJ;AAGLM,aAAOF,GAAGE,KAHL;AAILM,WAAK,8CAAqBR,GAAGQ,GAAxB,CAJA;AAKLC,WAAKT,GAAGS,GALH;AAMLC,gBAAUX,KAAKY,SAAL,IAAkBZ,KAAKa,SAAvB,IAAoC,IANzC;AAOLC,gBAAUP,eAAeP,KAAKgB,kBAApB;AAPL,KAAP;AASD;AACD,SAAO;AACLX,cAAUA,SAASL,IAAT,CADL;AAELH,UAAMI,GAAGJ,IAFJ;AAGLM,WAAOF,GAAGE,KAHL;AAILM,SAAK,8CAAqBR,GAAGQ,GAAxB,CAJA;AAKLC,SAAKT,GAAGS,GALH;AAMLC,cAAUX,KAAKY,SAAL,IAAkB,IANvB;AAOLE,cAAUf,iBAAiBC,IAAjB,EAAuBC,EAAvB,EAA2Bc,GAA3B,CAA+BR,cAA/B;AAPL,GAAP;AASD;;AAED,IAAMU,eAAe,EAAEC,WAAW,IAAb,EAArB;;IAEMC,mB;;;AACJ,iCAAc;AAAA;;AAAA;;AAAA,QAGJC,UAHI,GAGW,MAAKC,OAHhB,CAGJD,UAHI;;AAIZ,UAAKC,OAAL,gCACK,MAAKA,OADV;AAEEC,sDAAgD,IAFlD,EAEwD;AACtDC,yBAAmB,QAHrB;AAIEH,+CACKA,UADL;AAEEI,4BAAoB;AAClBC,uBAAa;AADK,SAFtB;AAKEC,yBAAiB;AACfC,4BAAkB;AADH;AALnB;AAJF;AAJY;AAkBb;;;;;mCAEmBN,O,EAAS;AAC3B,oDAAmB,OAAnB;AACA,YAAMO,UAAUP,QAAQQ,QAAR,IAAoBC,OAAOC,QAAP,CAAgBC,aAAhB,CAA8B,KAA9B,CAApC;AACA,YAAIrB,WAAW,IAAf;AACA,YAAMsB,UAAU,IAAhB;AACA,eAAO;AACLC,gBADK;AAAA,4BACEjC,EADF,EACMkC,OADN,EACeC,QADf,EACyB;AAC5B,kBAAIzB,aAAa,IAAjB,EAAuB;AAAA,oBACbd,IADa,GACQI,EADR,CACbJ,IADa;AAAA,oBACPM,KADO,GACQF,EADR,CACPE,KADO;AAAA,oBACAO,GADA,GACQT,EADR,CACAS,GADA;;AAErB,oBAAM2B;AACJC,6BAAWzC,IADP;AAEJ0C,0CAAwBlB,QAAQkB,sBAF5B;AAGJpC,8BAHI;AAIJgC;AAJI,mBAKAzB,OAAO,EAAEA,QAAF,EALP,CAAN;AAOA,oBAAM8B,wBAAwB,4CAAmBvC,EAAnB,+BAA4BoB,OAA5B,IAAqCY,gBAArC,IAA9B;AACA,oBAAMQ,YAAYC,mBAAMV,aAAN,CAAoBQ,qBAApB,EAA2CH,YAA3C,CAAlB;AACA1B,2BAAWgC,sBAAST,MAAT,CAAgBO,SAAhB,EAA2Bb,OAA3B,CAAX;AACA,oBAAI,OAAOQ,QAAP,KAAoB,UAAxB,EAAoC;AAClCA;AACD;AACF,eAfD,MAeO;AACLzB,yBAASiC,aAAT,CAAuB3C,GAAGE,KAA1B,EAAiCgC,OAAjC,EAA0CC,QAA1C;AACD;AACF;;AApBI;AAAA;AAqBLS,iBArBK;AAAA,+BAqBK;AACRF,oCAASG,sBAAT,CAAgClB,OAAhC;AACAjB,yBAAW,IAAX;AACD;;AAxBI;AAAA;AAyBLoC,iBAzBK;AAAA,+BAyBK;AACR,kBAAI,CAACpC,QAAL,EAAe;AACb,uBAAO,IAAP;AACD;AACD,qBAAO,+CACLsB,QAAQe,iBADH,EAELzC,eAAeI,SAASsC,sBAAxB,CAFK,EAGL5B,OAHK,CAAP;AAKD;;AAlCI;AAAA;AAmCL6B,uBAnCK;AAAA,mCAmCSC,IAnCT,EAmCeC,KAnCf,EAmCsBC,IAnCtB,EAmC4B;AAC/B,kBAAMC,cAAc,6CAAoBF,KAApB,EAA2BnC,YAA3B,CAApB;AACA,kBAAMsC,UAAUC,uBAAUC,QAAV,CAAmBH,WAAnB,CAAhB;AACA,kBAAI,CAACC,OAAL,EAAc;AACZ,sBAAM,IAAIG,SAAJ,8CAAiDN,KAAjD,wBAAN;AACD;AACD;AACAG,sBAAQZ,sBAASgB,WAAT,CAAqBR,KAAKxC,QAA1B,CAAR,EAA6C0C,IAA7C;AACD;;AA3CI;AAAA;AA4CLO,wBA5CK;AAAA,oCA4CUC,EA5CV,EA4Cc;AACjB,qBAAOlB,sBAASmB,uBAAT,CAAiCD,EAAjC,CAAP;AACD;;AA9CI;AAAA;AA+CLE,sCA/CK;AAAA,oDA+C0B;AAC7B,kDACK,IADL,EAEK,2DAAkC;AACnCC;AAAQ;AAAA,2BAAQzD,eAAeP,KAAKiD,sBAApB,CAAR;AAAA;;AAAR;AAAA,mBADmC;AAEnCgB;AAAyB;AAAA,2BAAMtD,QAAN;AAAA;;AAAzB;AAAA;AAFmC,eAAlC,CAFL;AAOD;;AAvDI;AAAA;AAAA,SAAP;AAyDD;;;;;;;uCAEqB,aAAe;AACnC,YAAMuD,WAAW,IAAIC,oBAAJ,EAAjB;AACA,YAAIC,QAAQ,KAAZ;AACA,YAAIC,aAAa,IAAjB;AACA,eAAO;AACLnC,gBADK;AAAA,4BACEjC,EADF,EACMkC,OADN,EACe;AAClBkC,2BAAapE,EAAb;AACA;AACA,kBAAI,OAAOA,GAAGJ,IAAV,KAAmB,QAAvB,EAAiC;AAC/BuE,wBAAQ,IAAR;AACD,eAFD,MAEO;AACLA,wBAAQ,KAAR;AACA,uBAAO,6CAAoB;AAAA,yBAAMF,SAAShC,MAAT,CAAgBjC,EAAhB,EAAoBkC,OAApB,CAAN;AAAA,iBAApB,CAAP;AACD;AACF;;AAVI;AAAA;AAWLU,iBAXK;AAAA,+BAWK;AACRqB,uBAASrB,OAAT;AACD;;AAbI;AAAA;AAcLE,iBAdK;AAAA,+BAcK;AACR,kBAAIqB,KAAJ,EAAW;AACT,uBAAO,uCAAcC,UAAd,CAAP;AACD;AACD,kBAAMC,SAASJ,SAASK,eAAT,EAAf;AACA,qBAAO;AACLlE,0BAAUT,wBAAwBsE,SAAStD,SAAT,CAAmBN,cAA3C,CADL;AAELT,sBAAMwE,WAAWxE,IAFZ;AAGLM,uBAAOkE,WAAWlE,KAHb;AAILM,qBAAK,8CAAqB4D,WAAW5D,GAAhC,CAJA;AAKLC,qBAAK2D,WAAW3D,GALX;AAMLC,0BAAUuD,SAAStD,SAAT,CAAmBA,SANxB;AAOLE,0BAAU,uCAAcwD,MAAd;AAPL,eAAP;AASD;;AA5BI;AAAA;AA6BLpB,uBA7BK;AAAA,mCA6BSC,IA7BT,EA6BeC,KA7Bf,EA6B+B;AAAA,gDAANoB,IAAM;AAANA,oBAAM;AAAA;;AAClC,kBAAMC,UAAUtB,KAAKhD,KAAL,CAAW,uCAAciD,KAAd,EAAqBnC,YAArB,CAAX,CAAhB;AACA,kBAAIwD,OAAJ,EAAa;AACX,6DAAoB,YAAM;AACxB;AACA;AACAP,2BAASJ,uBAAT,CAAiC,YAAM;AACrCW,gEAAWD,IAAX;AACD,mBAFD;AAGD,iBAND;AAOD;AACF;;AAxCI;AAAA;AAyCLZ,wBAzCK;AAAA,oCAyCUC,EAzCV,EAyCc;AACjB,qBAAO,6CAAoB;AAAA,uBAAMK,SAASJ,uBAAT,CAAiCD,EAAjC,CAAN;AAAA,eAApB,CAAP;AACD;;AA3CI;AAAA;AAAA,SAAP;AA6CD;;;;;;;oCAEoBxC,O,EAAS;AAC5B,eAAO;AACLa,gBADK;AAAA,4BACEjC,EADF,EACMkC,OADN,EACe;AAClB,kBAAId,QAAQc,OAAR,KAAoBlC,GAAGJ,IAAH,CAAQ6E,YAAR,IAAwBrD,QAAQsD,iBAApD,CAAJ,EAA4E;AAC1E,oBAAMA,iDACA1E,GAAGJ,IAAH,CAAQ6E,YAAR,IAAwB,EADxB,EAEDrD,QAAQsD,iBAFP,CAAN;AAIA,oBAAMC,iBAAiB,6CAAoB3E,EAApB,EAAwBkC,OAAxB,EAAiCwC,iBAAjC,CAAvB;AACA,uBAAOE,oBAAeC,oBAAf,CAAoCpC,mBAAMV,aAAN,CAAoB4C,cAApB,CAApC,CAAP;AACD;AACD,qBAAOC,oBAAeC,oBAAf,CAAoC7E,EAApC,CAAP;AACD;;AAXI;AAAA;AAAA,SAAP;AAaD;;;;;AAED;AACA;AACA;;;;;8BACeoB,O,EAAS;AACtB,gBAAQA,QAAQ0D,IAAhB;AACE,eAAKC,sBAAcC,KAAd,CAAoBC,KAAzB;AAAgC,mBAAO,KAAKC,mBAAL,CAAyB9D,OAAzB,CAAP;AAChC,eAAK2D,sBAAcC,KAAd,CAAoBG,OAAzB;AAAkC,mBAAO,KAAKC,qBAAL,CAA2BhE,OAA3B,CAAP;AAClC,eAAK2D,sBAAcC,KAAd,CAAoBK,MAAzB;AAAiC,mBAAO,KAAKC,oBAAL,CAA0BlE,OAA1B,CAAP;AACjC;AACE,kBAAM,IAAIvB,KAAJ,uDAAuDuB,QAAQ0D,IAA/D,EAAN;AALJ;AAOD;;;;;;;oBAEIS,O,EAAS;AACZ,eAAO,8BAAKA,OAAL,CAAP;AACD;;;;;AAED;AACA;AACA;AACA;;;;;6BACcrC,I,EAAM;AAClB,YAAI,CAACA,IAAD,IAAS,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAA7B,EAAuC,OAAO,IAAP;AACvC,eAAOT,mBAAMV,aAAN,CAAoBmB,KAAKtD,IAAzB,EAA+B,6CAAoBsD,IAApB,CAA/B,CAAP;AACD;;;;;;;6BAEaqC,O,EAAS;AACrB,eAAO,uCAAcA,OAAd,CAAP;AACD;;;;;;;8BAEcrC,I,EAAM;AACnB,eAAOR,sBAASgB,WAAT,CAAqBR,KAAKxC,QAA1B,CAAP;AACD;;;;;;;iCAEiBwC,I,EAAM;AACtB,eAAO,2CAAkBA,IAAlB,CAAP;AACD;;;;;;;8BAEcqC,O,EAAS;AACtB,eAAO,wBAAUA,OAAV,CAAP;AACD;;;;;;;kCAEkBC,M,EAAQ;AACzB,eAAO,iCAAmBA,MAAnB,CAAP;AACD;;;;;;;iCAEiBC,S,EAAW;AAC3B,eAAO,OAAOA,SAAP,KAAqB,UAA5B;AACD;;;;;;;+BAEsB;AACrB,eAAOhD,mBAAMV,aAAN,qCAAP;AACD;;;;;;;sCAEsBrB,Q,EAAUyB,Q,EAAU;AACzC;AACAA,iBAASuD,IAAT,CAAchF,QAAd,EAAwBiF,SAAxB;AACD;;;;;;;yCAEyBzC,I,EAAM9B,O,EAAS;AACvC,eAAO;AACLwE,oDADK;AAEL1C,gBAAM,mDAA0BT,mBAAMV,aAAhC,EAA+CmB,IAA/C,EAAqD9B,OAArD;AAFD,SAAP;AAID;;;;;;;EAxN+B2D,qB;;AA2NlCc,OAAOC,OAAP,GAAiB5E,mBAAjB","file":"ReactFifteenAdapter.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\n// eslint-disable-next-line import/no-unresolved, import/extensions\nimport ReactDOMServer from 'react-dom/server';\n// eslint-disable-next-line import/no-unresolved, import/extensions\nimport TestUtils from 'react-dom/test-utils';\n// eslint-disable-next-line import/no-unresolved, import/extensions\nimport ShallowRenderer from 'react-test-renderer/shallow';\nimport values from 'object.values';\nimport { isElement, isValidElementType } from 'react-is';\nimport { EnzymeAdapter } from 'enzyme';\nimport {\n  displayNameOfNode,\n  elementToTree,\n  mapNativeEventNames,\n  propFromEvent,\n  withSetStateAllowed,\n  assertDomAvailable,\n  createRenderWrapper,\n  createMountWrapper,\n  propsWithKeysAndRef,\n  ensureKeyOrUndefined,\n  wrap,\n  RootFinder,\n  getNodeFromRootFinder,\n  wrapWithWrappingComponent,\n  getWrappingComponentMountRenderer,\n} from 'enzyme-adapter-utils';\n\nfunction compositeTypeToNodeType(type) {\n  switch (type) {\n    case 0:\n    case 1: return 'class';\n    case 2: return 'function';\n    default:\n      throw new Error(`Enzyme Internal Error: unknown composite type ${type}`);\n  }\n}\nfunction childrenFromInst(inst, el) {\n  if (inst._renderedChildren) {\n    return values(inst._renderedChildren);\n  }\n  if (el.props) {\n    return values({ '.0': el.props.children });\n  }\n  return [];\n}\n\nfunction nodeType(inst) {\n  if (inst._compositeType != null) {\n    return compositeTypeToNodeType(inst._compositeType);\n  }\n  return 'host';\n}\n\nfunction instanceToTree(inst) {\n  if (!inst || typeof inst !== 'object') {\n    return inst;\n  }\n  const el = inst._currentElement;\n  if (el == null || el === false) {\n    return null;\n  }\n  if (typeof el !== 'object') {\n    return el;\n  }\n  if (inst._renderedChildren) {\n    return {\n      nodeType: nodeType(inst),\n      type: el.type,\n      props: el.props,\n      key: ensureKeyOrUndefined(el.key),\n      ref: el.ref,\n      instance: inst._instance || inst._hostNode || null,\n      rendered: values(inst._renderedChildren).map(instanceToTree),\n    };\n  }\n  if (inst._hostNode) {\n    return {\n      nodeType: 'host',\n      type: el.type,\n      props: el.props,\n      key: ensureKeyOrUndefined(el.key),\n      ref: el.ref,\n      instance: inst._instance || inst._hostNode || null,\n      rendered: childrenFromInst(inst, el).map(instanceToTree),\n    };\n  }\n  if (inst._renderedComponent) {\n    return {\n      nodeType: nodeType(inst),\n      type: el.type,\n      props: el.props,\n      key: ensureKeyOrUndefined(el.key),\n      ref: el.ref,\n      instance: inst._instance || inst._hostNode || null,\n      rendered: instanceToTree(inst._renderedComponent),\n    };\n  }\n  return {\n    nodeType: nodeType(inst),\n    type: el.type,\n    props: el.props,\n    key: ensureKeyOrUndefined(el.key),\n    ref: el.ref,\n    instance: inst._instance || null,\n    rendered: childrenFromInst(inst, el).map(instanceToTree),\n  };\n}\n\nconst eventOptions = { animation: true };\n\nclass ReactFifteenAdapter extends EnzymeAdapter {\n  constructor() {\n    super();\n\n    const { lifecycles } = this.options;\n    this.options = {\n      ...this.options,\n      supportPrevContextArgumentOfComponentDidUpdate: true, // TODO: remove, semver-major\n      legacyContextMode: 'parent',\n      lifecycles: {\n        ...lifecycles,\n        componentDidUpdate: {\n          prevContext: true,\n        },\n        getChildContext: {\n          calledByRenderer: true,\n        },\n      },\n    };\n  }\n\n  createMountRenderer(options) {\n    assertDomAvailable('mount');\n    const domNode = options.attachTo || global.document.createElement('div');\n    let instance = null;\n    const adapter = this;\n    return {\n      render(el, context, callback) {\n        if (instance === null) {\n          const { type, props, ref } = el;\n          const wrapperProps = {\n            Component: type,\n            wrappingComponentProps: options.wrappingComponentProps,\n            props,\n            context,\n            ...(ref && { ref }),\n          };\n          const ReactWrapperComponent = createMountWrapper(el, { ...options, adapter });\n          const wrappedEl = React.createElement(ReactWrapperComponent, wrapperProps);\n          instance = ReactDOM.render(wrappedEl, domNode);\n          if (typeof callback === 'function') {\n            callback();\n          }\n        } else {\n          instance.setChildProps(el.props, context, callback);\n        }\n      },\n      unmount() {\n        ReactDOM.unmountComponentAtNode(domNode);\n        instance = null;\n      },\n      getNode() {\n        if (!instance) {\n          return null;\n        }\n        return getNodeFromRootFinder(\n          adapter.isCustomComponent,\n          instanceToTree(instance._reactInternalInstance),\n          options,\n        );\n      },\n      simulateEvent(node, event, mock) {\n        const mappedEvent = mapNativeEventNames(event, eventOptions);\n        const eventFn = TestUtils.Simulate[mappedEvent];\n        if (!eventFn) {\n          throw new TypeError(`ReactWrapper::simulate() event '${event}' does not exist`);\n        }\n        // eslint-disable-next-line react/no-find-dom-node\n        eventFn(ReactDOM.findDOMNode(node.instance), mock);\n      },\n      batchedUpdates(fn) {\n        return ReactDOM.unstable_batchedUpdates(fn);\n      },\n      getWrappingComponentRenderer() {\n        return {\n          ...this,\n          ...getWrappingComponentMountRenderer({\n            toTree: inst => instanceToTree(inst._reactInternalInstance),\n            getMountWrapperInstance: () => instance,\n          }),\n        };\n      },\n    };\n  }\n\n  createShallowRenderer(/* options */) {\n    const renderer = new ShallowRenderer();\n    let isDOM = false;\n    let cachedNode = null;\n    return {\n      render(el, context) {\n        cachedNode = el;\n        /* eslint consistent-return: 0 */\n        if (typeof el.type === 'string') {\n          isDOM = true;\n        } else {\n          isDOM = false;\n          return withSetStateAllowed(() => renderer.render(el, context));\n        }\n      },\n      unmount() {\n        renderer.unmount();\n      },\n      getNode() {\n        if (isDOM) {\n          return elementToTree(cachedNode);\n        }\n        const output = renderer.getRenderOutput();\n        return {\n          nodeType: compositeTypeToNodeType(renderer._instance._compositeType),\n          type: cachedNode.type,\n          props: cachedNode.props,\n          key: ensureKeyOrUndefined(cachedNode.key),\n          ref: cachedNode.ref,\n          instance: renderer._instance._instance,\n          rendered: elementToTree(output),\n        };\n      },\n      simulateEvent(node, event, ...args) {\n        const handler = node.props[propFromEvent(event, eventOptions)];\n        if (handler) {\n          withSetStateAllowed(() => {\n            // TODO(lmr): create/use synthetic events\n            // TODO(lmr): emulate React's event propagation\n            renderer.unstable_batchedUpdates(() => {\n              handler(...args);\n            });\n          });\n        }\n      },\n      batchedUpdates(fn) {\n        return withSetStateAllowed(() => renderer.unstable_batchedUpdates(fn));\n      },\n    };\n  }\n\n  createStringRenderer(options) {\n    return {\n      render(el, context) {\n        if (options.context && (el.type.contextTypes || options.childContextTypes)) {\n          const childContextTypes = {\n            ...(el.type.contextTypes || {}),\n            ...options.childContextTypes,\n          };\n          const ContextWrapper = createRenderWrapper(el, context, childContextTypes);\n          return ReactDOMServer.renderToStaticMarkup(React.createElement(ContextWrapper));\n        }\n        return ReactDOMServer.renderToStaticMarkup(el);\n      },\n    };\n  }\n\n  // Provided a bag of options, return an `EnzymeRenderer`. Some options can be implementation\n  // specific, like `attach` etc. for React, but not part of this interface explicitly.\n  // eslint-disable-next-line class-methods-use-this, no-unused-vars\n  createRenderer(options) {\n    switch (options.mode) {\n      case EnzymeAdapter.MODES.MOUNT: return this.createMountRenderer(options);\n      case EnzymeAdapter.MODES.SHALLOW: return this.createShallowRenderer(options);\n      case EnzymeAdapter.MODES.STRING: return this.createStringRenderer(options);\n      default:\n        throw new Error(`Enzyme Internal Error: Unrecognized mode: ${options.mode}`);\n    }\n  }\n\n  wrap(element) {\n    return wrap(element);\n  }\n\n  // converts an RSTNode to the corresponding JSX Pragma Element. This will be needed\n  // in order to implement the `Wrapper.mount()` and `Wrapper.shallow()` methods, but should\n  // be pretty straightforward for people to implement.\n  // eslint-disable-next-line class-methods-use-this, no-unused-vars\n  nodeToElement(node) {\n    if (!node || typeof node !== 'object') return null;\n    return React.createElement(node.type, propsWithKeysAndRef(node));\n  }\n\n  elementToNode(element) {\n    return elementToTree(element);\n  }\n\n  nodeToHostNode(node) {\n    return ReactDOM.findDOMNode(node.instance);\n  }\n\n  displayNameOfNode(node) {\n    return displayNameOfNode(node);\n  }\n\n  isValidElement(element) {\n    return isElement(element);\n  }\n\n  isValidElementType(object) {\n    return isValidElementType(object);\n  }\n\n  isCustomComponent(component) {\n    return typeof component === 'function';\n  }\n\n  createElement(...args) {\n    return React.createElement(...args);\n  }\n\n  invokeSetStateCallback(instance, callback) {\n    // React in >= 15.4, and < 16 pass undefined to a setState callback\n    callback.call(instance, undefined);\n  }\n\n  wrapWithWrappingComponent(node, options) {\n    return {\n      RootFinder,\n      node: wrapWithWrappingComponent(React.createElement, node, options),\n    };\n  }\n}\n\nmodule.exports = ReactFifteenAdapter;\n"]}